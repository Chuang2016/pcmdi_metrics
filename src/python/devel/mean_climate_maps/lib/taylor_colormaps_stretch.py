import vcs, MV2
import EzTemplate
from matplotlib.colors import LinearSegmentedColormap

C_pcmdi = [
99,99,99,
0,0,0,
87,88,87,
24,24,24,
99,99,99,
99,99,0,
0,0,99,
0,0,99,
0,0,99,
0,11,99,
0,11,99,
0,11,99,
0,11,99,
0,22,99,
0,22,99,
0,24,99,
84,84,84,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,48,0,
99,62,0,
99,81,0,
99,99,24,
68,99,99,
35,88,99,
0,77,99,
0,0,99,
71,40,99,
99,0,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
97,37,99,
68,57,99,
0,0,99,
0,66,99,
51,95,99,
77,99,99,
99,99,64,
99,82,24,
99,62,24,
99,46,22,
99,0,0,
51,0,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
84,11,99,
62,37,99,
0,0,99,
0,66,99,
37,92,99,
68,99,99,
99,99,24,
99,82,24,
99,62,24,
99,46,22,
99,0,0,
51,0,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
44,11,62,
11,11,84,
24,48,90,
40,64,90,
55,81,94,
68,92,99,
99,82,81,
99,70,68,
97,44,44,
99,24,24,
71,0,0,
37,0,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
0,11,99,
0,40,99,
20,60,99,
40,80,99,
60,93,99,
80,99,99,
99,99,80,
99,93,60,
99,80,40,
99,60,20,
99,40,0,
99,11,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
44,11,62,
0,40,99,
20,60,99,
40,80,99,
60,93,99,
80,99,99,
99,99,80,
99,93,60,
99,80,40,
99,60,20,
99,40,11,
99,11,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
44,11,62,
0,40,99,
20,60,99,
40,80,99,
60,93,99,
80,99,99,
99,93,60,
99,80,40,
99,60,20,
99,40,11,
99,0,0,
51,0,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
44,11,62,
0,40,99,
20,60,99,
40,80,99,
60,93,99,
80,99,99,
99,93,60,
99,80,40,
99,60,20,
99,46,22,
99,0,0,
51,0,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
24,0,94,
26,51,94,
40,70,94,
55,81,94,
68,92,99,
99,82,81,
99,70,68,
97,44,44,
99,24,24,
71,0,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
24,2,100,
26,51,94,
40,70,94,
55,81,94,
68,92,99,
99,82,81,
99,70,68,
97,44,44,
99,24,24,
71,0,0,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,93,60,
99,80,40,
99,60,20,
99,40,11,
99,0,0,
51,0,0,
44,11,62,
0,40,99,
20,60,99,
40,80,99,
60,93,99,
80,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99,
99,99,99 ]

R = []
G = []
B = []

for i in range(0,720,3):
  R.append(C_pcmdi[i])
for i in range(1,720,3):
  G.append(C_pcmdi[i])
for i in range(2,720,3):
  B.append(C_pcmdi[i])

vcs.utils.defaultColorsRange = range(16,240)
v = vcs.init(geometry={"width":1000,"height":500}, bg=1) # Create a vcs Canvas
cmap = v.createcolormap('tylor13_all_bands', 'default') # Create a colormap

labels = []

for i in range(0,240):
  cmap.setcolorcell(i,R[i],G[i],B[i],100)

  if i > 0 and i < 240: 
    if R[i]!=99 or G[i]!=99 or B[i]!=99:
      if R[i-1]==99 and G[i-1]==99 and B[i-1]==99:
        labels.append(i)
      if R[i+1]==99 and G[i+1]==99 and B[i+1]==99:
        labels.append(i+1)

#print labels

#####################################################################

def SpreadBand(i1,i2,cm_name):

  # Append colors in each as tuples
  colors = []
  for i in range(i1,i2):
    colors.append((R[i]/100.,G[i]/100.,B[i]/100.))

  # Create the colormap (Matplotlib)
  cmap_name = 'my _list'
  cm = LinearSegmentedColormap.from_list(cmap_name, colors, N=240)

  # Convert Matplotlib colormap to VCS one
  vcs_cmap = vcs.colors.matplotlib2vcs(cm, vcs_name=cm_name)

  return(vcs_cmap)

#####################################################################

#cmlst = []
#cmlst.append(cmap) # Original one at the beginning

for i in range(0,len(labels),2):
  i1 = labels[i]
  i2 = labels[i+1]
  cm_name = 'band_'+str(i/2) 
  #cmlst.append(SpreadBand(i1,i2,cm_name))
  SpreadBand(i1,i2,cm_name)


#####################################################################
